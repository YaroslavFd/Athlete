"use strict";function disableScroll(){var e=window.scrollY;document.body.classList.add("disable-scroll"),document.body.dataset.position=e,document.body.style.top=-e+"px"}function enableScroll(){var e=parseInt(document.body.dataset.position,10);document.body.style.top="auto",document.body.classList.remove("disable-scroll"),window.scroll({top:e,left:0}),document.body.removeAttribute("data-position")}var burger=document.querySelector(".burger"),menu=document.querySelector(".header__nav");burger.addEventListener("click",(function(){burger.classList.toggle("burger--active"),menu.classList.toggle("header__nav--active"),burger.classList.contains("burger--active")?disableScroll():enableScroll()})),$(".header__nav .nav__link").click((function(e){$(menu).removeClass("header__nav--active"),$(burger).removeClass("burger--active"),enableScroll()}));var cartBtn=document.querySelector(".cart__btn"),miniCart=document.querySelector(".mini-cart");cartBtn.addEventListener("click",(function(){miniCart.classList.add("mini-cart--visible")})),document.addEventListener("click",(function(e){e.target.classList.contains("mini-cart")||e.target.closest(".mini-cart")||e.target.classList.contains("cart__btn")||e.target.classList.contains("mini-product__delete")||miniCart.classList.remove("mini-cart--visible")}));var accordions=document.querySelectorAll(".faq-accordion");function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}accordions.forEach((function(e){e.addEventListener("click",(function(e){var t=e.currentTarget,r=t.querySelector(".faq-accordion__control"),n=t.querySelector(".faq-accordion__content");t.classList.toggle("open"),t.classList.contains("open")?(r.setAttribute("aria-expanded",!0),n.setAttribute("aria-hidden",!1),n.style.maxHeight=n.scrollHeight+"px"):(r.setAttribute("aria-expanded",!1),n.setAttribute("aria-hidden",!0),n.style.maxHeight=null)}))})),$(".catalog__caption").click((function(e){$(this).next(".catalog__prop-inner").slideToggle(200)})),$(".catalog__caption").click((function(e){$(this).toggleClass("catalog__caption--active")})),$(".catalog__filter-btn").click((function(e){$(this).next(".catalog-filters").slideToggle(200)})),$(".catalog__item-btn--brand").click((function(e){$(".catalog__list--brand").toggleClass("catalog__list--brand-more"),$(".catalog__item--brand-hidden").toggleClass("catalog__item--brand-visible");var t=$(this),r=t.text(),n=t.data("label");t.text(n).data("label",r)})),$(".catalog__item-btn--category").click((function(e){$(".catalog__list--category").toggleClass("catalog__list--category-more"),$(".catalog__item--category-hidden").toggleClass("catalog__item--category-visible");var t=$(this),r=t.text(),n=t.data("label");t.text(n).data("label",r)}));var catalogList=document.querySelector(".catalog-list"),catalogMore=document.querySelector(".catalog__more"),prodModal=document.querySelector('[data-graph-target="prod-modal"] .modal-content'),prodModalSlider=prodModal.querySelector(".modal-slider .swiper-wrapper"),prodModalPreview=prodModal.querySelector(".modal-slider .modal-preview"),prodModalInfo=prodModal.querySelector(".modal-info__wrapper"),prodModalDescr=prodModal.querySelector(".modal-prod-descr"),prodModalChars=prodModal.querySelector(".prod-chars"),prodModalVideo=prodModal.querySelector(".prod-modal__video"),prodQuantity=9,dataLength=null,modal=null,normalPrice=function(e){return String(e).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")},prodSlider=new Swiper(".modal-slider__container",{slidesPerView:1,spaceBetween:20,autoHeight:!0});if(catalogList){var loadProducts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9;fetch("../data/data.json").then((function(e){return e.json()})).then((function(t){dataLength=t.length,catalogList.innerHTML="";for(var r=0;r<dataLength;r++)if(r<e){var n=t[r];catalogList.innerHTML+='\n\n              <li class="catalog-list__item">\n                <article class="product">\n                  <div class="product__image">\n                    <img src="'.concat(n.mainImage,'" alt="').concat(n.title,'">\n                    <div class="product__btns">\n                      <button class="btn-reset product__btn" data-graph-path="prod-modal" data-id="').concat(n.id,'" aria-label="Показать информацию о товаре">\n                        <svg>\n                          <use xlink:href="img/sprite.svg#eye"></use>\n                        </svg>\n                      </button>\n                    </div>\n                  </div>\n                  <div class="product__content">\n                      <h3 class="product__title">').concat(n.title,'</h3>\n                      <span class="product__type">').concat(n.type,'</span>\n                      <div class="product__rate">\n                        <svg>\n                            <use xlink:href="').concat(n.rate,'"></use>\n                        </svg>\n                        <svg>\n                            <use xlink:href="').concat(n.rate,'"></use>\n                        </svg>\n                        <svg>\n                          <use xlink:href="').concat(n.rate,'"></use>\n                        </svg>\n                        <svg>\n                          <use xlink:href="').concat(n.rate,'"></use>\n                        </svg>\n                        <svg>\n                          <use xlink:href="').concat(n.rateDisabled,'"></use>\n                        </svg>\n                      </div>\n                      <div class="product__footer">\n                        <span class="product__price">').concat(normalPrice(n.price),' р</span>\n                        <button class="btn-reset product__footer-btn add-to-cart-btn" data-id="').concat(n.id,'" aria-label="Добавить товар в корзину">\n                        В корзину\n                      </button>\n                    </div>\n                  </div>\n                </article>\n              </li>\n\n            ')}})).then((function(){document.querySelectorAll(".product__title, .popular-card__title").forEach((function(e){$clamp(e,{clamp:"30px"})})),document.querySelectorAll(".product__btn").forEach((function(e){e.addEventListener("focus",(function(e){e.currentTarget.closest(".product__btns").classList.add("product__btns--active")}),!0),e.addEventListener("blur",(function(e){e.currentTarget.closest(".product__btns").classList.remove("product__btns--active")}),!0)})),cartLogic(),modal=new GraphModal({isOpen:function(e){if(e.modalContainer.classList.contains("prod-modal")){var t=e.previousActiveElement.dataset.id;loadModalData(t),prodSlider.update()}}})}))};loadProducts(prodQuantity);var loadModalData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;fetch("../data/data.json").then((function(e){return e.json()})).then((function(t){prodModalSlider.innerHTML="",prodModalPreview.innerHTML="",prodModalInfo.innerHTML="",prodModalDescr.textContent="",prodModalChars.innerHTML="",prodModalVideo.innerHTML="";var r,n=_createForOfIteratorHelper(t);try{var a=function(){var t=r.value;if(t.id==e){var n=t.gallery.map((function(e,t){return'\n                <div class="swiper-slide" data-index="'.concat(t,'">\n                  <img src="').concat(e,'" alt="">\n                </div>\n              ')})),a=t.gallery.map((function(e,t){return'\n                <div class="modal-preview__item '.concat(0===t?"modal-preview__item--active":"",'" tabindex="0" data-index="').concat(t,'">\n                  <img src="').concat(e,'" alt="">\n                </div>\n              ')}));t.sizes.map((function(e,t){return'\n                <li class="modal-sizes__item">\n                  <button class="btn-reset modal-sizes__btn">'.concat(e,"</button>\n                </li>\n              ")}));prodModalSlider.innerHTML=n.join(""),prodModalPreview.innerHTML=a.join(""),prodModalInfo.innerHTML='\n\n              <h3 class="modal-info__title">'.concat(t.title,'</h3>\n              <div class="modal-info__rate">\n                <svg>\n                  <use xlink:href="img/sprite.svg#star"></use>\n                </svg>\n                <svg>\n                  <use xlink:href="img/sprite.svg#star"></use>\n                </svg>\n                <svg>\n                  <use xlink:href="img/sprite.svg#star"></use>\n                </svg>\n                <svg>\n                  <use xlink:href="img/sprite.svg#star"></use>\n                </svg>\n                <svg>\n                    <use xlink:href="img/sprite.svg#starDisabled"></use>\n                </svg>\n              </div>\n              <div class="modal-info__price">\n                <span class="modal-info__current-price">').concat(t.price,' р</span>\n                <span class="modal-info__old-price">').concat(t.oldPrice?t.oldPrice+"р":"",'</span>\n              </div>\n              <div class="modal-info__delivery">\n                <div class="modal-info__delivery-content">\n                  <span class="modal-info__delivery-title">\n                    Доставка бесплатно!\n                  </span>\n                  <p class="modal-info__delivery-text">\n                    При покупке товара на сумму свыше 3000 рублей доставка осуществляется бесплатно!\n                  </p>\n                  <img class="modal-info__delivery-img" src="img/delivery.png" alt="delivery">\n              </div>\n            </div>\n            '),prodModalDescr.textContent=t.description;var o="";Object.keys(t.chars).forEach((function(e){o+='<p class="prod-bottom__descr prod-chars__item"><span>'.concat(e,":</span> ").concat(t.chars[e],"</p>")})),prodModalChars.innerHTML=o,t.video?(prodModalVideo.style.display="block",prodModalVideo.innerHTML='\n                <iframe src="'.concat(t.video,'"\n                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"\n                allowfullscreen></iframe>\n              ')):prodModalVideo.style.display="none"}};for(n.s();!(r=n.n()).done;)a()}catch(e){n.e(e)}finally{n.f()}})).then((function(){prodSlider.update(),prodSlider.on("slideChangeTransitionEnd",(function(){var e=document.querySelector(".swiper-slide-active").dataset.index;document.querySelectorAll(".modal-preview__item").forEach((function(e){e.classList.remove("modal-preview__item--active")})),document.querySelector('.modal-preview__item[data-index="'.concat(e,'"]')).classList.add("modal-preview__item--active")})),document.querySelectorAll(".modal-preview__item").forEach((function(e){e.addEventListener("click",(function(e){var t=parseInt(e.currentTarget.dataset.index);document.querySelectorAll(".modal-preview__item").forEach((function(e){e.classList.remove("modal-preview__item--active")})),e.currentTarget.classList.add("modal-preview__item--active"),prodSlider.slideTo(t)}))}))}))}}var price=0,miniCartList=document.querySelector(".mini-cart__list"),fullPrice=document.querySelector(".mini-cart__summ"),cartCount=document.querySelector(".cart__count"),priceWithoutSpaces=function(e){return e.replace(/\s/g,"")},plusFullPrice=function(e){return price+=e},minusFullPrice=function(e){return price-=e},printFullPrice=function(){fullPrice.textContent="".concat(normalPrice(price)," р")},printQuantity=function(e){cartCount.textContent=e},loadCartData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;fetch("../data/data.json").then((function(e){return e.json()})).then((function(t){var r,n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.id==e)return miniCartList.insertAdjacentHTML("afterbegin",'\n              <li class="mini-cart__item" data-id="'.concat(a.id,'">\n                <article class="mini-cart__product mini-product">\n                  <div class="mini-product__image">\n                    <img src="').concat(a.mainImage,'" alt="').concat(a.title,'">\n                  </div>\n                  <div class="mini-product__content">\n                    <div class="mini-product__text">\n                      <h3 class="mini-product__title">').concat(a.title,'</h3>\n                      <span class="mini-product__price">').concat(normalPrice(a.price),' р</span>\n                    </div>\n                    <button class="btn-reset mini-product__delete" aria-label="Удалить товар">\n                      Удалить\n                      <svg>\n                        <use xlink:href="img/sprite.svg#trash"></use>\n                      </svg>\n                    </button>\n                  </div>\n                </article>\n              </li>\n            ')),a}}catch(e){n.e(e)}finally{n.f()}})).then((function(e){plusFullPrice(e.price),printFullPrice();var t=document.querySelectorAll(".mini-cart__list .mini-cart__item").length;t>0&&cartCount.classList.add("cart__count--visible"),printQuantity(t)}))},cartLogic=function(){document.querySelectorAll(".add-to-cart-btn").forEach((function(e){e.addEventListener("click",(function(e){var t=e.currentTarget.dataset.id;loadCartData(t),document.querySelector(".cart__btn").classList.remove("cart__btn--inactive"),e.currentTarget.classList.add("product__btn--disabled")}))})),miniCartList.addEventListener("click",(function(e){if(e.target.classList.contains("mini-product__delete")){var t=e.target.closest(".mini-cart__item"),r=parseInt(priceWithoutSpaces(t.querySelector(".mini-product__price").textContent)),n=t.dataset.id;document.querySelector('.add-to-cart-btn[data-id="'.concat(n,'"]')).classList.remove("product__btn--disabled"),t.remove(),minusFullPrice(r),printFullPrice();var a=document.querySelectorAll(".mini-cart__list .mini-cart__item").length;0==a&&(cartCount.classList.remove("cart__count--visible"),miniCart.classList.remove("mini-cart--visible"),document.querySelector(".cart__btn").classList.add("cart__btn--inactive")),printQuantity(a)}}))},openOrderModal=document.querySelector(".mini-cart__btn"),orderModalList=document.querySelector(".cart-modal-order__list"),orderModalQuantity=document.querySelector(".cart-modal-order__quantity span"),orderModalSumm=document.querySelector(".cart-modal-order__summ span"),orderModalShow=document.querySelector(".cart-modal-order__show");openOrderModal.addEventListener("click",(function(){var e=document.querySelector(".mini-cart__list").innerHTML;orderModalList.innerHTML=e,orderModalQuantity.textContent="".concat(document.querySelectorAll(".mini-cart__list .mini-cart__item").length," шт"),orderModalSumm.textContent=fullPrice.textContent})),orderModalShow.addEventListener("click",(function(){orderModalList.classList.contains("cart-modal-order__list--visible")?(orderModalList.classList.remove("cart-modal-order__list--visible"),orderModalShow.classList.remove("cart-modal-order__show--active")):(orderModalList.classList.add("cart-modal-order__list--visible"),orderModalShow.classList.add("cart-modal-order__show--active"))})),orderModalList.addEventListener("click",(function(e){if(e.target.classList.contains("mini-product__delete")){var t=e.target.closest(".mini-cart__item"),r=parseInt(priceWithoutSpaces(t.querySelector(".mini-product__price").textContent)),n=t.dataset.id;document.querySelector('.add-to-cart-btn[data-id="'.concat(n,'"]')).classList.remove("product__btn--disabled"),t.style.display="none",setTimeout((function(){t.remove()}),100),document.querySelector('.mini-cart__item[data-id="'.concat(n,'"]')).remove(),minusFullPrice(r),printFullPrice(),setTimeout((function(){var e=document.querySelectorAll(".cart-modal-order__list .mini-cart__item").length;0==e&&(cartCount.classList.remove("cart__count--visible"),miniCart.classList.remove("mini-cart--visible"),document.querySelector(".cart__btn").classList.add("cart__btn--inactive"),modal.close()),printQuantity(e)}),100)}}));var rangeSlider=document.getElementById("range-slider");if(rangeSlider){noUiSlider.create(rangeSlider,{start:[500,2e4],connect:!0,step:1,range:{min:[500],max:[2e4]}});var input0=document.getElementById("input-0"),input1=document.getElementById("input-1"),inputs=[input0,input1];rangeSlider.noUiSlider.on("update",(function(e,t){inputs[t].value=Math.round(e[t])}));var setRangeSlider=function(e,t){var r=[null,null];r[e]=t,rangeSlider.noUiSlider.set(r)};inputs.forEach((function(e,t){e.addEventListener("change",(function(e){setRangeSlider(t,e.currentTarget.value)}))}))}var popular=new Swiper(".popular-slider__container",{slidesPerView:4,spaceBetween:20,breakpoints:{320:{slidesPerView:1.2},450:{slidesPerView:1.5},576:{slidesPerView:1.7},650:{slidesPerView:2.2},768:{slidesPerView:2.7},1100:{slidesPerView:3.7}},loop:!0,autoplay:{delay:1500,disableOnInteraction:!1},speed:800}),reviews=new Swiper(".reviews__slider",{pagination:{el:".swiper-pagination",clickable:!0},autoplay:{delay:3e3},speed:800}),styles=getComputedStyle(document.documentElement),colorValue=styles.getPropertyValue("--color-accent"),selector=document.querySelector('input[type="tel"]'),im=new Inputmask("+7 (999) 999-9999");im.mask(selector);var productsFormData=null,validateForms=function(e,t,r,n,a){new window.JustValidate(e,{rules:t,messages:r,colorWrong:colorValue,submitHandler:function(e){if(console.log(e),e.classList.contains("cart-modal__form")){productsFormData=new FormData(document.querySelector(".cart-modal__form")),document.querySelectorAll(".cart-modal-order__list .mini-cart__item").forEach((function(e,t){var r=e.querySelector(".mini-product__title").textContent,n=e.querySelector(".mini-product__price").textContent;productsFormData.append("product-".concat(t+1),"".concat(r,", ").concat(n))})),productsFormData.append("summ","".concat(document.querySelector(".cart-modal-order__summ span").textContent));var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&200===t.status&&console.log("Отправлено")},t.open("POST","mail.php",!0),t.send(productsFormData),e.reset()}else{var r=new FormData(e),n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&console.log("Отправлено")},n.open("POST","mail.php",!0),n.send(r),e.reset()}}})};validateForms(".callback-form",{name:{required:!0},phone:{required:!0}},{name:{required:"Вы должны ввести имя"},phone:{required:"Вы должны ввести телефон"}},".thanks-popup"),validateForms(".cart-modal__form",{name:{required:!0},phone:{required:!0},email:{required:!0,email:!0}},{name:{required:"Вы должны ввести имя"},phone:{required:"Вы должны ввести телефон"},email:{required:"Вы должны ввести email",email:"Вы должны ввести корректный email"}},".thanks-popup");